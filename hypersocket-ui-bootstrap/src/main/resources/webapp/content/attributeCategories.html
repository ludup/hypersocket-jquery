<div id="attributeCategoryContent">
	<div class="modal" id="addResourceForm" tabindex="-1" role="dialog"
		dialog-for="attributeCategoryContent">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"
						aria-hidden="true">&times;</button>
					<h4 class="modal-title"></h4>
				</div>
				<div class="modal-body">
					<form class="form">
						<div class="propertyItem form-group">
							<label class="col-md-3 control-label" localize="attributeCategory.name.label"></label>
							<div class="propertyValue col-md-9">
								<input type="text" name="attributeCategoryName" id="attributeCategoryNameInput" class="form-control" />
								<div>
									<span class="help-block" localize="attributeCategory.name.info"></span>
								</div>
							</div>
						</div>
						<div id="attributeCategoryPropertiesPanel" class="panel panel-default">
							<div class="panel-heading">
								<h2>
									<i class="fa fa-th"></i><span class="break"></span>
								</h2>
								<ul id="attributeCategoryPropertiesTabs" class="nav nav-tabs">
									<li id="tabRolesLi" class="active" role="tab" data-toggle="tab">
										<a href="#tabRoles" class="attributeCategoryPropertiesTab attributeCategoryPropertiesTab2">
											<span localize="attributeCategory.attributeCategory.label"></span>
										</a>
									</li>
								</ul>
							</div>
							<div class="panel-body">
								<div id="attributeCategoryPropertiesContent" class="tab-content">
									<div id="tabRoles" class="dialogTab tab-pane active container-fluid">
										<div class="propertyItem form-group">
											<label class="col-md-3 control-label" localize="attributeCategory.weight.label"></label>
											<div class="propertyValue col-md-9">
												<input type="number" name="attributeCategoryWeight" id="attributeCategoryWeightInput" class="form-control" />
												<div>
													<span class="help-block" localize="attributeCategory.weight.info"></span>
												</div>
											</div>
										</div>
										<div class="propertyItem form-group">
											<label class="col-md-3 control-label" localize="attributeCategory.context.label"></label>
											<div class="propertyValue col-md-9">
												<div name="attributeCategoryContext" id="attributeCategoryContextInput"></div>
												<div>
													<span class="help-block" localize="attributeCategory.context.info"></span>
												</div>
											</div>
										</div>
										<input type="hidden" name="attributeCategoryId" id="attributeCategoryIdInput">
									</div>
								</div>
							</div>
						</div>

					</form>
				</div>
				<div class="modal-footer"></div>
			</div>
		</div>
	</div>
	<div id="additionalActions"></div>
</div>

<script type="text/javascript">
	$(document)
			.ready(
					function() {

						$('#attributeCategoryContent').localize();
						
						$('#attributeCategoryContextInput').selectButton({
							id: 'attributeCategoryContext',
							options: [{ id: 'Password', name: 'Password', value: 'Password' }, 
							          { id: 'Text', name: 'Text', value: 'Text'}],
							nameIsResourceKey: false
						});
						
						getJSON('menus/tableActions/attributeActions', null, function(data) {
							var actions = new Array();
							
							if(data.resources.length > 0) {
								$.each(data.resources, function(idx, action) {
									var div = action.resourceKey + 'Div';
									$('#additionalActions').append('<div id="' + div + '"></div>');
									$('#' + div).load('content/' + action.url + '.html');
									actions.push({
										resourceKey : action.resourceKey,
										iconClass : action.iconClass,
										action : function(resource, callback) {
											if($('#' + action.resourceKey).data('action')) {
												$('#' + action.resourceKey).data('action')(resource, callback);
											}
										},
										enabled : true,
										enableFunction: action.enableFunction,
										displayFunction: action.displayFunction
									});
								});
							}

							$('#attributeCategoryContent').ajaxResourcePage(
										{
											id : "attributeCategory",
											title : getResource('attributeCategory.title'),
											icon : 'fa-list-ul',
											tableUrl : "attributeCategories/table",
											resourceUrl : "attributeCategories/attributeCategory",
											fields : [
												{name : "name"}
												],
											resourceKey : "attributeCategory",
											canCreate : true,
											canDelete : true,
											canUpdate : true,
											additionalActionsDropdown: true,
											additionalActions : actions,
											validate : function() {
												if ($('#attributeCategoryNameInput').val() == '') {
													$('#addResourceForm').resourceDialog('error', 'attributeCategory.nameRequired.error');
													return false;
												}
												if ($('#attributeCategoryWeightInput').val() == '') {
													$('#addResourceForm').resourceDialog('error', 'attributeCategory.weightRequired.error');
													return false;
												}
												if ($('#attributeCategoryContextInput').data('widget').getValue() == '') {
													$('#addResourceForm').resourceDialog('error', 'attributeCategory.contextRequired.error');
													return false;
												}
												return true;
											},
											clearDialog : function() {
												$('#attributeCategoryNameInput').val('');
												$('#attributeCategoryWeightInput').val('');
												$('#attributeCategoryContextInput').data('widget').reset();
												$('#attributeCategoryIdInput').val('');
											},
											createResource : function() {
												resource = new Object();
												resource.name = $('#attributeCategoryNameInput').val();
												resource.weight = $('#attributeCategoryWeightInput').val();
												resource.context = $('#attributeCategoryContextInput').data('widget').getValue();
												resource.id = $('#attributeCategoryIdInput').val();
												return resource;
											},
											displayResource : function(
													resource) {
												$('#attributeCategoryNameInput').val(resource.name);
												$('#attributeCategoryWeightInput').val(resource.weight);
												$('#attributeCategoryContextInput').data('widget').setValue(resource.context);
												$('#attributeCategoryIdInput').val(resource.id);
											},
											complete : function() {
												loadComplete();
											}
							});
						});
					});
</script>
